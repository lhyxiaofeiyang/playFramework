<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html id="top" xmlns="http://www.w3.org/1999/xhtml" xmlns:jspwiki="http://www.jspwiki.org"><head>
  <title>
    PlayFramework：显示文章和发布评论
  </title>
  











<link rel="stylesheet" media="screen, projection, print" type="text/css" href="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki.css">

<link rel="stylesheet" type="text/css" media="print" href="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki_print.css">
<!-- INCLUDERESOURCES (stylesheet) -->

<!-- INCLUDERESOURCES (inlinecss) -->



<noscript>
<style type="text/css">
#hiddenmorepopup { display:block; }
</style>
</noscript>


<script type="text/javascript" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/mootools.js"></script>
<script type="text/javascript" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/prettify.js"></script>
<script type="text/javascript" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki-common.js"></script>
<script type="text/javascript" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki-commonstyles.js"></script>
<!-- INCLUDERESOURCES (script) -->





<meta name="wikiContext" content="view">
<meta name="wikiBaseUrl" content="http://www.playframework.cn/">
<meta name="wikiPageUrl" content="/wiki/%23%24%25">
<meta name="wikiEditUrl" content="/Edit.jsp?page=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA">
<meta name="wikiJsonUrl" content="/JSON-RPC">
<meta name="wikiPageName" content="显示文章和发布评论">
<meta name="wikiUserName" content="119.137.62.59">
<meta name="wikiTemplateUrl" content="/templates/default/">
<meta name="wikiApplicationName" content="PlayFramework">

<script type="text/javascript">//<![CDATA[
/* Localized javascript strings: LocalizedStrings[] */
var LocalizedStrings = {
"javascript.edit.allsections":"（全部）",
"javascript.slimbox.error":"<h2>错误</h2> 您的请求有问题。<br />请重试",
"javascript.slimbox.remoteRequest":"远程请求 {0}（共 {1} 个）",
"javascript.slimbox.close":"关闭 &#215;",
"javascript.quick.edit":"[编辑]",
"javascript.sort.descending":"降序。单击反转排序顺序",
"javascript.expand":"单击扩展",
"javascript.group.validName":"请为新组指定有效的名称",
"javascript.slimbox.next":"下一个&raquo;",
"javascript.filter.all":"（全部）",
"javascript.edit.areyousure":"如果没有单击“保存”按钮所做的更改将丢失。是否要退出此页面？",
"javascript.quick.edit.title":"编辑段落 {0}...",
"javascript.slimbox.directLink":"到目标的直接链接",
"javascript.prefs.areyousure":"如果没有单击“保存用户首选项”按钮，前面所做的更改将丢失。是否要退出此页面？",
"javascript.sbox.clone.suffix":"-New",
"javascript.slimbox.info":"图像 {0}（共 {1} 个）",
"javascript.tip.default.title":"更多...",
"javascript.edit.resize":"拖动来调整文本区的大小",
"javascript.edit.findandreplace.nomatch":"未找到匹配项！",
"javascript.sort.ascending":"升序。单击反转排序顺序",
"javascript.slimbox.close.title":"关闭 [Esc]",
"javascript.edit.toolbar.makeSelection":"请先进行选择。",
"javascript.favs.hide":"单击隐藏收藏夹",
"javascript.sectionediting.label":"段落概览",
"javascript.slimbox.previous":"&laquo;上一个",
"javascript.favs.show":"单击显示收藏夹",
"javascript.collapse":"单击折叠",
"javascript.category.title":"单击显示类别 [{0}] ...",
"javascript.sort.click":"单击排序",
"javascript.edit.startOfPage":"（页面开始）"
};


/* INCLUDERESOURCES (jsfunction) */

//]]></script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="search" href="http://www.playframework.cn/wiki/FindPage" title="Search PlayFramework">
<link rel="help" href="http://www.playframework.cn/wiki/TextFormattingRules" title="Help">

 <link rel="start" href="http://www.playframework.cn/wiki/PlayFramework%20Tutorial" title="Front page">
<link rel="alternate stylesheet" type="text/css" href="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki_print.css" title="Print friendly">
<link rel="alternate stylesheet" type="text/css" href="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/jspwiki.css" title="Standard">
<link rel="shortcut icon" type="image/x-icon" href="http://www.playframework.cn/images/favicon.ico">

<link rel="icon" type="image/x-icon" href="http://www.playframework.cn/images/favicon.ico">



  










  
  
  
</head>

<body class="view">

<div id="wikibody" class="fav-left">
 
  






<div id="header">

  <div class="titlebox"></div>

  <div class="applicationlogo"> 
    <a href="http://www.playframework.cn/wiki/PlayFramework%20Tutorial" title="转到主页 PlayFramework Tutorial ">主页</a>
  </div>

  <div class="companylogo"></div>

  






<div class="userbox">

  
    <span class="username anonymous">
      您好（匿名访客）
    </span>
  
  
  

  
  
  
    
      <a href="http://www.playframework.cn/Login.jsp?redirect=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA" class="action login" title="登录或注册为新用户">登录</a>
    
  
  
  
  

  
  
    <a href="http://www.playframework.cn/UserPreferences.jsp?redirect=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA" class="action prefs" accesskey="p" title="管理首选项 [ p ]">我的首选项(<span class="accesskey">P</span>)
    </a>
  
  

  <div class="clearbox"></div>

</div>

  <div class="pagename">显示文章和发布评论</div>

  <div class="searchbox">






<form action="/Search.jsp" class="wikiform" id="searchForm" accept-charset="UTF-8">

  <div style="position:relative">
  <input onblur="if( this.value == '' ) { this.value = this.defaultValue }; return true; " onfocus="if( this.value == this.defaultValue ) { this.value = ''}; return true; " value="快速导航" name="query" id="query" size="20" accesskey="f" autocomplete="off" type="text">
  <button type="submit" name="searchSubmit" id="searchSubmit" value="转到！" title="转到！"></button>
  </div>
  <div id="searchboxMenu" style="visibility: hidden; opacity: 0;" visibility="visible">
    <div id="searchTools">
      <a href="#" id="quickView" class="action" onclick="SearchBox.navigate( '/wiki/__PAGEHERE__','查看选定页面' );" title="查看选定页面">查看</a>
      <a href="#" id="quickEdit" class="action" onclick="SearchBox.navigate( '/Edit.jsp?page=__PAGEHERE__','编辑选定页面' );" title="编辑选定页面">编辑</a>
      <a href="#" id="quickClone" class="action" onclick="return SearchBox.navigate( '/Edit.jsp?page=__PAGEHERE__', '复制选定页面', true );" title="复制选定页面">复制</a>
      <a href="#" id="advancedSearch" class="action" onclick="SearchBox.navigate( 'http://www.playframework.cn/Search.jsp?query=__PAGEHERE__','显示文章和发布评论' )" title="高级搜索 [ f ]">查找</a>
    </div>
    <div id="searchResult">
	  快速搜索
      <span id="searchTarget">（输入提示）</span>
      <span id="searchSpin" class="spin" style="position:absolute;display:none;"></span>
	  <div id="searchOutput"></div>
    </div>
    <div id="recentSearches" style="display:none;">
      最近的搜索
      <span><a href="#" id="recentClear">（清除）</a></span>
    </div>
  </div>

</form></div>

  <div class="breadcrumbs">浏览记录：&nbsp;<a class="wikipage" href="http://www.playframework.cn/wiki/PlayFramework%20Tutorial">PlayFramework Tutorial</a>, <a class="wikipage" href="http://www.playframework.cn/wiki/Bespin%E5%9C%A8%E7%BA%BF%E7%BC%96%E8%BE%91%E5%99%A8">Bespin在线编辑器</a></div>

</div>

  <div id="content">

    <div id="page">
      





<div id="actionsTop" class="pageactions"> 
  <ul>

    
    
    

    
    <li id="morebutton" href="#">
      <a href="http://www.playframework.cn/wiki/MoreMenu" class="action more">更多...</a>
    <ul id="morepopup" style="visibility: hidden; opacity: 0;">
     
       	
     
       
     
    
       
     
       <li>
       
       <a class="action rawpage wikipage" href="http://www.playframework.cn/wiki/%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA?skin=raw" title="查看页面源代码">查看页面源代码
       </a>
       
       
       </li>
      
        
  
      
      
      

      
	  <li class="separator">
        <div id="moremenu"></div>
      </li>
  </ul></li>

  </ul>
</div>

      








<div class="tabmenu">

  

  

  
  
  
    
  
    
  



  <a class="activetab" id="menu-pagecontent" accesskey="v">查看</a>

  

  
  <a id="menu-attach" accesskey="a">附件</a>
  
    
  <a id="menu-info" href="http://www.playframework.cn/PageInfo.jsp?page=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA" accesskey="i">信息</a>
    
  

</div>
<div class="tabs">

  <div id="pagecontent">

    











<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;完成了博客首页后，本节我们开始编写文章的详情页面。文章的详情页面会显示关于当前文章的所有评论，并包含发布新评论的表单。
</p><p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.1_E5_88_9B_E5_BB_BAshowAction">12.4.1 创建show Action<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.1_E5_88_9B_E5_BB_BAshowAction">#</a></h3>
<p></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了显示文章详情页面，我们需要在Application控制器中编写一个新的Action方法，命名为show()：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> show</span><span class="pun">(</span><span class="typ">Long</span><span class="pln"> id</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Post</span><span class="pln"> post </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">id</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; render</span><span class="pun">(</span><span class="pln">post</span><span class="pun">);</span><span class="pln"><br></span><span class="pun">}</span></pre>
</div>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这个Action非常简单，声明了Long id作为方法变量，自动获取HTTP中的id参数。这个参数可以是HTTP查询字符串、URL路径或者表单请求体。
</p>
<p><br>
</p>
<div class="quote">
提示：
<p>如果接收到的HTTP参数id不合法，框架会为show()中的id变量赋空值，并且在日志中增加一条相应的错误信息。
</p></div>

<p><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上述Action对应渲染/yabe/app/views/Application/show.html模板：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="com">#{extends 'main.html' /}</span><span class="pln"><br></span><span class="com">#{set title:post.title /}</span><span class="pln"><br>&nbsp;<br></span><span class="com">#{display post:post, as:'full' /}</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show.html模板中使用了我们之前编写的#{display}标签，所以这个页面看上去非常简洁。
</p>
<p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.2_E6_B7_BB_E5_8A_A0_E8_AF_A6_E6_83_85_E9_A1_B5_E9_9D_A2_E9_93_BE_E6_8E_A5">12.4.2 添加详情页面链接<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.2_E6_B7_BB_E5_8A_A0_E8_AF_A6_E6_83_85_E9_A1_B5_E9_9D_A2_E9_93_BE_E6_8E_A5">#</a></h3>
<p></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在原先定义的#{display}标签中，并没有设置任何链接（使用href="#"），现在我们将这些链接指向show Action。在模板中使用@{...}就可以很容易进行链接，该语法是通过检索路由配置解析需要访问指定Action的URL来实现的。编辑/yabe/app/views/tags/display.html标签：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">...</span><span class="pln"><br></span><span class="pun">&lt;</span><span class="pln">h2 </span><span class="kwd">class</span><span class="pun">=</span><span class="str">"post-title"</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">a href</span><span class="pun">=</span><span class="str">"@{Application.show(_post.id)}"</span><span class="pun">&gt;</span><span class="pln">$</span><span class="pun">{</span><span class="pln">_post</span><span class="pun">.</span><span class="pln">title</span><span class="pun">}&lt;/</span><span class="pln">a</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">&lt;/</span><span class="pln">h2</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">...</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;刷新主页，如图12.9所示，点击文章标题可以进入详情页面。
</p>
<p><img class="inline" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/guide4-0.png" alt="图片资源/guide4-0.png">
</p>
<p>
</p><p><b>(图12.9 刷新主页后结果)</b>
</p>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;页面的主要功能已经完成，但还缺少返回主页的链接，编辑/yabe/app/views/main.html模板完善标题的链接：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">...</span><span class="pln"><br></span><span class="pun">&lt;</span><span class="pln">div id</span><span class="pun">=</span><span class="str">"title"</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">span </span><span class="kwd">class</span><span class="pun">=</span><span class="str">"about"</span><span class="pun">&gt;</span><span class="typ">About</span><span class="pln"> </span><span class="kwd">this</span><span class="pln"> blog</span><span class="pun">&lt;/</span><span class="pln">span</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">h1</span><span class="pun">&gt;&lt;</span><span class="pln">a href</span><span class="pun">=</span><span class="str">"@{Application.index()}"</span><span class="pun">&gt;</span><span class="pln">$</span><span class="pun">{</span><span class="pln">blogTitle</span><span class="pun">}&lt;/</span><span class="pln">a</span><span class="pun">&gt;&lt;/</span><span class="pln">h1</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">h2</span><span class="pun">&gt;</span><span class="pln">$</span><span class="pun">{</span><span class="pln">blogBaseline</span><span class="pun">}&lt;/</span><span class="pln">h2</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">&lt;/</span><span class="pln">div</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">...</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现在就可以在主页和文章详情页面之间进行导航了。
</p>
<p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.3_E9_85_8D_E7_BD_AE_E6_9B_B4_E5_8F_8B_E5_A5_BD_E7_9A_84URL">12.4.3 配置更友好的URL<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.3_E9_85_8D_E7_BD_AE_E6_9B_B4_E5_8F_8B_E5_A5_BD_E7_9A_84URL">#</a></h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于我们并没有进行路由配置，框架采用了默认的catch all路由规则：
<p></p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">*</span><span class="pln"> &nbsp; &nbsp; &nbsp; </span><span class="pun">/{</span><span class="pln">controller</span><span class="pun">}/{</span><span class="pln">action</span><span class="pun">}</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">{</span><span class="pln">controller</span><span class="pun">}.{</span><span class="pln">action</span><span class="pun">}</span></pre>
</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所以目前文章详情页面的URL为：
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">/</span><span class="pln">application</span><span class="pun">/</span><span class="pln">show</span><span class="pun">?</span><span class="pln">id</span><span class="pun">=</span><span class="lit">1</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这样的URL并不是最合适的，随着业务的增加系统的URL会变得非常混乱，难以管理。编辑/yabe/conf/routes文件，为Application.show Action定义一个更清晰的URL：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pln">GET &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">/</span><span class="pln">posts</span><span class="pun">/{</span><span class="pln">id</span><span class="pun">}</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">Application</span><span class="pun">.</span><span class="pln">show</span></pre>
</div>
<p><br>
</p>
<div class="quote">
注意：
<p>id参数从URL路径中获取。
</p></div>

<p><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;刷新浏览器，检查预期的URL是否正确执行。
</p>
<p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.4_E6_B7_BB_E5_8A_A0_E4_B8_8A_E4_B8_8B_E7_AF_87_E5_AF_BC_E8_88_AA">12.4.4 添加上下篇导航<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.4_E6_B7_BB_E5_8A_A0_E4_B8_8A_E4_B8_8B_E7_AF_87_E5_AF_BC_E8_88_AA">#</a></h3>
<p></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通常的博客系统会为用户提供文章上下篇导航的功能，方便用户连续地浏览文章，我们的博客引擎也不例外。接下来为我们的博客引擎增加上下篇导航功能，首先扩展Post类，添加获取前一篇和后一篇文章的方法：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="kwd">public</span><span class="pln"> </span><span class="typ">Post</span><span class="pln"> previous</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">"postedAt &lt; ? order by postedAt desc"</span><span class="pun">,</span><span class="pln"> postedAt</span><span class="pun">).</span><span class="pln">first</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br>&nbsp;<br></span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Post</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">"postedAt &gt; ? order by postedAt asc"</span><span class="pun">,</span><span class="pln"> postedAt</span><span class="pun">).</span><span class="pln">first</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>
</div>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;之后在show.html模板的最顶端增加上下篇导航的链接（#{display/}标签之前）：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="tag">&lt;ul </span><span class="atn">id</span><span class="tag">=</span><span class="atv">"pagination"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; #{if post.previous()}<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;li </span><span class="atn">id</span><span class="tag">=</span><span class="atv">"previous"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;a </span><span class="atn">href</span><span class="tag">=</span><span class="atv">"@{Application.show(post.previous().id)}"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ${post.previous().title}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;/a&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;/li&gt;</span><span class="pln"><br>&nbsp; &nbsp; #{/if}<br>&nbsp; &nbsp; #{if post.next()}<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;li </span><span class="atn">id</span><span class="tag">=</span><span class="atv">"next"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;a </span><span class="atn">href</span><span class="tag">=</span><span class="atv">"@{Application.show(post.next().id)}"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ${post.next().title}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;/a&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="tag">&lt;/li&gt;</span><span class="pln"><br>&nbsp; &nbsp; #{/if}<br></span><span class="tag">&lt;/ul&gt;</span></pre>
</div>
<p>
</p><p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.5_E6_B7_BB_E5_8A_A0_E8_AF_84_E8_AE_BA_E5_8A_9F_E8_83_BD">12.4.5 添加评论功能<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.5_E6_B7_BB_E5_8A_A0_E8_AF_84_E8_AE_BA_E5_8A_9F_E8_83_BD">#</a></h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现上下篇导航后，我们还要为文章添加评论功能。在Appliction控制器中添加postComment Action：
<p></p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> postComment</span><span class="pun">(</span><span class="typ">Long</span><span class="pln"> postId</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> author</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> content</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Post</span><span class="pln"> post </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; post</span><span class="pun">.</span><span class="pln">addComment</span><span class="pun">(</span><span class="pln">author</span><span class="pun">,</span><span class="pln"> content</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; show</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br></span><span class="pun">}</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;postComment Action中使用到了之前在Post类中定义的addComment()方法，可以非常方便的为文章添加评论。继续修改模板，在show.html模板中添加提交评论的HTML表单（在#{display}标签之后）：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">&lt;</span><span class="pln">h3</span><span class="pun">&gt;</span><span class="typ">Post</span><span class="pln"> a comment</span><span class="pun">&lt;/</span><span class="pln">h3</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp;<br></span><span class="com">#{form @Application.postComment(post.id)}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">label </span><span class="kwd">for</span><span class="pun">=</span><span class="str">"author"</span><span class="pun">&gt;</span><span class="typ">Your</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">label</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">input type</span><span class="pun">=</span><span class="str">"text"</span><span class="pln"> name</span><span class="pun">=</span><span class="str">"author"</span><span class="pln"> id</span><span class="pun">=</span><span class="str">"author"</span><span class="pln"> </span><span class="pun">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">label </span><span class="kwd">for</span><span class="pun">=</span><span class="str">"content"</span><span class="pun">&gt;</span><span class="typ">Your</span><span class="pln"> message</span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">label</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">textarea name</span><span class="pun">=</span><span class="str">"content"</span><span class="pln"> id</span><span class="pun">=</span><span class="str">"content"</span><span class="pun">&gt;&lt;/</span><span class="pln">textarea</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">input type</span><span class="pun">=</span><span class="str">"submit"</span><span class="pln"> value</span><span class="pun">=</span><span class="str">"Submit your comment"</span><span class="pln"> </span><span class="pun">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="com">#{/form}</span></pre>
</div>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;修改模板后刷新页面，查看是否如图12.10所示，并尝试发布一条新的评论：
</p>
<p><img class="inline" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/guide4-1.png" alt="图片资源/guide4-1.png">
</p>
<p>
</p><p><b>(图12.10 发布一条新评论)</b>
</p>
<p><br>
</p><h3 id="section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.6_E6_B7_BB_E5_8A_A0_E9_AA_8C_E8_AF_81">12.4.6 添加验证<a class="hashlink" href="#section-_E6_98_BE_E7_A4_BA_E6_96_87_E7_AB_A0_E5_92_8C_E5_8F_91_E5_B8_83_E8_AF_84_E8_AE_BA-12.4.6_E6_B7_BB_E5_8A_A0_E9_AA_8C_E8_AF_81">#</a></h3>
<p></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目前的系统并不具备数据验证的能力，程序不能在用户发布评论时对表单内容进行验证。我们可以为博客引擎添加适当的验证机制，增强系统程序的健壮性(如设置所有表单项都为必填)。修改postComment Action，在参数前增加验证注解，然后在方法体内检查是否有错误发生：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> postComment</span><span class="pun">(</span><span class="typ">Long</span><span class="pln"> postId</span><span class="pun">,</span><span class="pln"> </span><span class="lit">@Required</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> author</span><span class="pun">,</span><span class="pln"> </span><span class="lit">@Required</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> content</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Post</span><span class="pln"> post </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">hasErrors</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; render</span><span class="pun">(</span><span class="str">"Application/show.html"</span><span class="pun">,</span><span class="pln"> post</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; post</span><span class="pun">.</span><span class="pln">addComment</span><span class="pun">(</span><span class="pln">author</span><span class="pun">,</span><span class="pln"> content</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; show</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br></span><span class="pun">}</span></pre>
</div>
<p><br>
</p>
<div class="quote">
注意：
<p>不要忘记导入play.data.validation包。
</p>
<p></p></div>

<p><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如出现验证错误，重定向至文章详情页面，并提示错误信息。修改模板中表单代码，用于显示错误提示信息：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">&lt;</span><span class="pln">h3</span><span class="pun">&gt;</span><span class="typ">Post</span><span class="pln"> a comment</span><span class="pun">&lt;/</span><span class="pln">h3</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp;<br></span><span class="com">#{form @Application.postComment(post.id)}</span><span class="pln"><br>&nbsp;<br>&nbsp; &nbsp; </span><span class="com">#{ifErrors}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p </span><span class="kwd">class</span><span class="pun">=</span><span class="str">"error"</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">All</span><span class="pln"> fields are required</span><span class="pun">!</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">#{/ifErrors}</span><span class="pln"><br>&nbsp;<br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">label </span><span class="kwd">for</span><span class="pun">=</span><span class="str">"author"</span><span class="pun">&gt;</span><span class="typ">Your</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">label</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">input type</span><span class="pun">=</span><span class="str">"text"</span><span class="pln"> name</span><span class="pun">=</span><span class="str">"author"</span><span class="pln"> id</span><span class="pun">=</span><span class="str">"author"</span><span class="pln"> value</span><span class="pun">=</span><span class="str">"${params.author}"</span><span class="pln"> </span><span class="pun">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">label </span><span class="kwd">for</span><span class="pun">=</span><span class="str">"content"</span><span class="pun">&gt;</span><span class="typ">Your</span><span class="pln"> message</span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">label</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">textarea name</span><span class="pun">=</span><span class="str">"content"</span><span class="pln"> id</span><span class="pun">=</span><span class="str">"content"</span><span class="pun">&gt;</span><span class="pln">$</span><span class="pun">{</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">content</span><span class="pun">}&lt;/</span><span class="pln">textarea</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">input type</span><span class="pun">=</span><span class="str">"submit"</span><span class="pln"> value</span><span class="pun">=</span><span class="str">"Submit your comment"</span><span class="pln"> </span><span class="pun">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="com">#{/form}</span></pre>
</div>
<p>
</p><p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了使用户体验更加友好，可以通过JavaScript实现当产生错误时自动聚焦到评论表单，方便用户再次输入。我们选择jQuery和jQuery Tools库来实现该功能，将这两个类库拷贝至/yabe/public/javascripts目录，并更改main.html主模板将它们引入：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">...</span><span class="pln"><br></span><span class="pun">&lt;</span><span class="pln">script src</span><span class="pun">=</span><span class="str">"@{'/public/javascripts/jquery-1.4.2.min.js'}"</span><span class="pun">&gt;&lt;/</span><span class="pln">script</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">&lt;</span><span class="pln">script src</span><span class="pun">=</span><span class="str">"@{'/public/javascripts/jquery.tools-1.2.5.toolbox.expose.min.js'}"</span><span class="pun">&gt;&lt;/</span><span class="pln">script</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="pun">&lt;/</span><span class="pln">head</span><span class="pun">&gt;</span></pre>
</div>
<p>
</p><p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在show.html模板中添加如下脚本（添加至页面的最底端）：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="tag">&lt;script </span><span class="atn">type</span><span class="tag">=</span><span class="atv">"text/javascript"</span><span class="tag"> </span><span class="atn">charset</span><span class="tag">=</span><span class="atv">"utf-8"</span><span class="tag">&gt;</span><span class="embsrc"><span class="pln"><br>&nbsp; &nbsp; $</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'form'</span><span class="pun">).</span><span class="pln">click</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'form'</span><span class="pun">).</span><span class="pln">expose</span><span class="pun">({</span><span class="pln">api</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">}).</span><span class="pln">load</span><span class="pun">();</span><span class="pln"> <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">});</span><span class="pln"> <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// 如果出现错误，聚焦到表单</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">$</span><span class="pun">(</span><span class="str">'form .error'</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'form'</span><span class="pun">).</span><span class="pln">expose</span><span class="pun">({</span><span class="pln">api</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> loadSpeed</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">}).</span><span class="pln">load</span><span class="pun">();</span><span class="pln"> <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'form input[type=text]'</span><span class="pun">).</span><span class="pln">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">).</span><span class="pln">focus</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">});</span><span class="pln"><br></span></span><span class="tag">&lt;/script&gt;</span></pre>
</div>
<p><img class="inline" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/guide4-2.png" alt="图片资源/guide4-2.png">
</p>
<p>
</p><p><b>(图12.11 显示错误信息)</b>
</p>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有关发表评论的功能已经完善的差不多了，接着再做一些功能细化的操作。当用户成功发布一条评论时，界面显示发布成功的信息。该功能需要使用Play提供的Flash，在两个连续的Action之间保持信息的传递。
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;更改postComment Action添加成功信息：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> postComment</span><span class="pun">(</span><span class="typ">Long</span><span class="pln"> postId</span><span class="pun">,</span><span class="pln"> </span><span class="lit">@Required</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> author</span><span class="pun">,</span><span class="pln"> </span><span class="lit">@Required</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> content</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Post</span><span class="pln"> post </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Post</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">hasErrors</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; render</span><span class="pun">(</span><span class="str">"Application/show.html"</span><span class="pun">,</span><span class="pln"> post</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; post</span><span class="pun">.</span><span class="pln">addComment</span><span class="pun">(</span><span class="pln">author</span><span class="pun">,</span><span class="pln"> content</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; flash</span><span class="pun">.</span><span class="pln">success</span><span class="pun">(</span><span class="str">"Thanks for posting %s"</span><span class="pun">,</span><span class="pln"> author</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; show</span><span class="pun">(</span><span class="pln">postId</span><span class="pun">);</span><span class="pln"><br></span><span class="pun">}</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在show.html中显示成功发布的信息（添加到页面的最顶端），如图12.12所示：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pun">...</span><span class="pln"><br></span><span class="com">#{if flash.success}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="pln">p </span><span class="kwd">class</span><span class="pun">=</span><span class="str">"success"</span><span class="pun">&gt;</span><span class="pln">$</span><span class="pun">{</span><span class="pln">flash</span><span class="pun">.</span><span class="pln">success</span><span class="pun">}&lt;/</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln"><br></span><span class="com">#{/if}</span><span class="pln"><br>&nbsp;<br></span><span class="com">#{display post:post, as:'full' /}</span><span class="pln"><br></span><span class="pun">...</span></pre>
</div>
<p><img class="inline" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/guide4-3.png" alt="图片资源/guide4-3.png">
</p>
<p><b>(图12.12 显示成功发布消息)</b>
</p>
<p>
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最后通过路由配置，对postComment Action使用的URL进行调整。在routes文件中添加对应的路由，使URL更加清晰：
</p>
<div class="prettify">
<pre class="prettyprint prettified"><span class="pln">POST &nbsp; &nbsp;</span><span class="pun">/</span><span class="pln">posts</span><span class="pun">/{</span><span class="pln">postId</span><span class="pun">}/</span><span class="pln">comments &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">Application</span><span class="pun">.</span><span class="pln">postComment</span></pre>
</div>







        
  </div>


  

  
  <div id="attach" class="hidetab">

    










<div id="addattachment">
<h3>添加新附件</h3>


<div class="formhelp">只有授权的用户才能上传新附件。</div>

</div>



  </div>

  
    
  <div id="info" class="hidetab">

  </div>

    
  

<div style="clear:both;"></div>
</div>

      







<div id="actionsBottom" class="pageactions"> 
    

    <a href="#top" class="action quick2top" title="转到顶部">«</a>

    
       该页面（修订版 14）最后由 郑舒天 在 <a href="http://www.playframework.cn/Diff.jsp?page=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA&amp;r1=14&amp;r2=13">14-Feb-2012 08:25</a> 修改。
    

    

   

  

   
</div>

    </div>

    






<div id="favorites">

  






<div class="userbox">

  
    <span class="username anonymous">
      您好（匿名访客）
    </span>
  
  
  

  
  
  
    
      <a href="http://www.playframework.cn/Login.jsp?redirect=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA" class="action login" title="登录或注册为新用户">登录</a>
    
  
  
  
  

  
  
    <a href="http://www.playframework.cn/UserPreferences.jsp?redirect=%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA" class="action prefs" accesskey="p" title="管理首选项 [ p ]">我的首选项(<span class="accesskey">P</span>)
    </a>
  
  

  <div class="clearbox"></div>

</div>
  
  <div id="hiddenmorepopup">
  
  </div>
  
  

  

  

  
  <div class="leftmenu">
    <hr>
<p><b>Play!China Wiki</b>
</p>
<p>
</p><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/PlayFramework%20Tutorial">书籍撰写</a>
</li></ul><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/PlayChina%20Team">团队首页</a>
</li></ul><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90">图片资源</a>
</li></ul><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/%E7%A4%BE%E5%8C%BA%E7%8E%B0%E7%8A%B6">社区现状</a>
</li></ul><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/%E5%8F%91%E5%B1%95%E8%BD%A8%E8%BF%B9">发展轨迹</a>
</li></ul><ul><li><a class="wikipage" href="http://www.playframework.cn/wiki/%E8%81%94%E7%B3%BB%E6%88%91%E4%BB%AC">联系我们</a>
</li></ul>
    
  </div>
  
  <div class="leftmenufooter">
    <hr>
<p><b>Official Platform</b>
</p>
<ul><li><a class="external" href="http://www.oopsplay.org/">官方门户</a><img class="outlink" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/out.png" alt="">
</li></ul><p>
</p><ul><li><a class="external" href="mailto:dhl@playframework.cn">团队邮箱</a><img class="outlink" src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/out.png" alt="">
</li></ul><p>
</p><hr>
<b>Cooperative Site</b>
<p><br>
</p><table class="imageplugin" border="0">
<tbody><tr><td><img src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/oschina_logo.png"></td></tr>
</tbody></table>

<table class="imageplugin" border="0">
<tbody><tr><td><img src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/logo.gif" width="165" height="75"></td></tr>
</tbody></table>

<table class="imageplugin" border="0">
<tbody><tr><td><img src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/1.jpg" width="165" height="165"></td></tr>
</tbody></table>

<p></p>
<p>
    
  </p></div>

  

  
  <!-- 
  <div class="wikiversion">JSPWiki v2.8.4
  --> 
 <span class="rssfeed">
    
  </span>
  </div>  
  <div style="display:none">
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1252938720'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/stat.php%3Fid%3D1252938720' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_1252938720"><a href="http://www.cnzz.com/stat/website.php?web_id=1252938720" target="_blank" title="站长统计">站长统计</a></span><script src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/stat.php" type="text/javascript"></script><script src="%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E5%92%8C%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA_files/core.php" charset="utf-8" type="text/javascript"></script>
  </div>
</div>


	<div class="clearbox"></div>
  </div>

  





 
<div id="footer">

  <div class="applicationlogo"> 
    <a href="http://www.playframework.cn/wiki/PlayFramework%20Tutorial" title="转到主页 PlayFramework Tutorial ">主页</a>
  </div>

  <div class="companylogo"></div>

  <div class="copyright"></div>

  <div class="wikiversion">
    JSPWiki v2.8.4
  </div>

  <div class="rssfeed">
    
  </div>

</div>






</body></html>